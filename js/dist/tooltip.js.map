{"version":3,"sources":["../src/tooltip.js"],"names":["KeyCodes","ESCAPE","Selectors","DATA_TOOLTIP","DATA_VISIBLE","DATA_TARGET","ROLE","ARIA_DESCRIBEDBY","DROP_LEFT_CLASS","DROP_RIGHT_CLASS","Events","CLICK","MOUSEENTER","MOUSELEAVE","FOCUS","BLUR","KEYDOWN","Messages","NO_ID_ERROR","Tooltip","_render","bind","_handleClose","_handleEscapeKeyPress","_setCursorPointer","_setCursorAuto","_allTooltipTriggers","document","querySelectorAll","forEach","element","id","getAttribute","trigger","querySelector","_getTargetAttr","console","error","tooltip","getElementById","_setupTooltip","iOSMobile","removeEventListener","event","preventDefault","_activeTooltip","_activeTrigger","target","_activeTooltipId","tooltipId","_isLeftOrRight","_alignTooltip","_showTooltip","_listenForClose","_hideTooltip","_listenForOpen","which","setAttribute","addEventListener","property","triggerLength","_getComputedLength","tooltipLength","triggerIsLongest","offset","style","top","left","stopPropagation","body","cursor","parseInt","window","getComputedStyle","slice","classes","classList","contains"],"mappings":"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","sourcesContent":["// TODO: Add tests\r\n\r\nimport { iOSMobile } from \"./utils\"\r\n\r\nconst KeyCodes = {\r\n  ESCAPE: 27,\r\n}\r\n\r\nconst Selectors = {\r\n  DATA_TOOLTIP: \"data-tooltip\",\r\n  DATA_VISIBLE: \"data-visible\",\r\n  DATA_TARGET: \"data-target\",\r\n  ROLE: \"role\",\r\n  ARIA_DESCRIBEDBY: \"aria-describedby\",\r\n  DROP_LEFT_CLASS: \"is-drop-left\",\r\n  DROP_RIGHT_CLASS: \"is-drop-right\",\r\n}\r\n\r\nconst Events = {\r\n  CLICK: \"click\",\r\n  MOUSEENTER: \"onmouseenter\",\r\n  MOUSELEAVE: \"onmouseleave\",\r\n  FOCUS: \"focus\",\r\n  BLUR: \"blur\",\r\n  KEYDOWN: \"keydown\",\r\n}\r\n\r\nconst Messages = {\r\n  NO_ID_ERROR: \"Could not find an tooltip trigger associated with your element. Make sure your `data-tooltip` and `data-target` attributes have matching values.\",\r\n}\r\n\r\n/**\r\n * Tooltip component class.\r\n * @module Tooltip\r\n */\r\nexport default class Tooltip {\r\n  constructor() {\r\n    // events\r\n    this._render = this._render.bind(this)\r\n    this._handleClose = this._handleClose.bind(this)\r\n    this._handleEscapeKeyPress = this._handleEscapeKeyPress.bind(this)\r\n    this._setCursorPointer = this._setCursorPointer.bind(this)\r\n    this._setCursorAuto = this._setCursorAuto.bind(this)\r\n\r\n    // active tooltip (touch devices only)\r\n    this._allTooltipTriggers = []\r\n  }\r\n\r\n  // public\r\n\r\n  start() {\r\n    this._allTooltipTriggers = document.querySelectorAll(`[${Selectors.DATA_TOOLTIP}]`)\r\n\r\n    this._allTooltipTriggers.forEach(element => {\r\n      const id = element.getAttribute(Selectors.DATA_TOOLTIP)\r\n\r\n      let trigger\r\n      if (!element.querySelector(this._getTargetAttr(id))) {\r\n        return console.error(Messages.NO_ID_ERROR)\r\n      } else {\r\n        trigger = element.querySelector(this._getTargetAttr(id))\r\n      }\r\n\r\n      const tooltip = document.getElementById(id)\r\n      this._setupTooltip(trigger, tooltip, id)\r\n    })\r\n  }\r\n\r\n  stop() {\r\n    if (iOSMobile) {\r\n      this._allTooltipTriggers.forEach(element => {\r\n        element.removeEventListener(Events.CLICK, this._setCursorPointer)\r\n      })\r\n    }\r\n  }\r\n\r\n  // private\r\n\r\n  _render(event) {\r\n    event.preventDefault()\r\n\r\n    // if (iOSMobile && event.type === Events.CLICK) {\r\n    //   event.stopPropagation()\r\n    //   document.body.addEventListener(Events.CLICK, this._setCursorAuto)\r\n    //   document.body.style.cursor = \"pointer\"\r\n    // }\r\n\r\n    if (this._activeTooltip) {\r\n      this._handleClose(event)\r\n    }\r\n\r\n    this._activeTrigger = event.target\r\n    this._activeTooltipId = trigger.getAttribute(Selectors.DATA_TARGET)\r\n    this._activeTooltip = document.getElementById(tooltipId)\r\n    \r\n    if (this._isLeftOrRight()) {\r\n      this._alignTooltip(\"height\")\r\n    } else {\r\n      this._alignTooltip(\"width\")\r\n    }\r\n\r\n    this._showTooltip()\r\n    this._listenForClose()\r\n  }\r\n\r\n  _handleClose(event) {\r\n    event.preventDefault()\r\n\r\n    this._hideTooltip()\r\n\r\n    // if (iOSMobile) {\r\n    //   document.body.removeEventListener(Events.CLICK, this._setCursorAuto)\r\n    //   document.body.style.cursor = \"auto\"\r\n    // }\r\n  \r\n    this._activeTrigger = null\r\n    this._activeTooltipId = null\r\n    this._activeTooltip = null\r\n    \r\n    this._listenForOpen()\r\n  }\r\n\r\n  _handleEscapeKeyPress(event) {\r\n    event.preventDefault()\r\n    if (event.which === Events.ESCAPE) this._handleClose(event)\r\n  }\r\n\r\n  _showTooltip() {\r\n    this._activeTooltip.setAttribute(Selectors.DATA_VISIBLE, \"true\")\r\n  }\r\n\r\n  _hideTooltip() {\r\n    this._activeTooltip.setAttribute(Selectors.DATA_VISIBLE, \"false\")\r\n  }\r\n\r\n  _listenForClose() {\r\n    this._activeTrigger.removeEventListener(Events.MOUSEENTER, this._render)\r\n    this._activeTrigger.removeEventListener(Events.FOCUS, this._render)\r\n    document.addEventListener(Events.KEYDOWN, this._handleEscapeKeyPress)\r\n    this._activeTrigger.addEventListener(Events.MOUSELEAVE, this._handleClose)\r\n    this._activeTrigger.addEventListener(Events.BLUR, this._handleClose)\r\n  }\r\n\r\n  _listenForOpen() {\r\n    this._activeTrigger.removeEventListener(Events.MOUSELEAVE, this._render)\r\n    this._activeTrigger.removeEventListener(Events.BLUR, this._render)\r\n    document.removeEventListener(Events.KEYDOWN, this._handleEscapeKeyPress)\r\n    this._activeTrigger.addEventListener(Events.MOUSEENTER, this._handleClose)\r\n    this._activeTrigger.addEventListener(Events.FOCUS, this._handleClose)\r\n  }\r\n\r\n  _alignTooltip(property) {\r\n    const triggerLength = this._getComputedLength(this._activeTrigger, property)\r\n    const tooltipLength = this._getComputedLength(this._activeTooltip, property)\r\n    const triggerIsLongest = triggerLength > tooltipLength\r\n\r\n    const offset = triggerIsLongest\r\n      ? (triggerLength - tooltipLength) / 2\r\n      : (tooltipLength - triggerLength) / -2\r\n\r\n    if (property === \"height\") {\r\n      this._activeTooltip.style.top = `${offset}px`\r\n    } else {\r\n      this._activeTooltip.style.left = `${offset}px`\r\n    }\r\n  }\r\n\r\n  _setCursorPointer(event) {\r\n    event.preventDefault()\r\n    event.stopPropagation()\r\n    document.body.addEventListener(Events.CLICK, this._setCursorAuto)\r\n    document.body.style.cursor = \"pointer\"\r\n  }\r\n\r\n  _setupTooltip(trigger, tooltip, id) {\r\n    trigger.setAttribute(Selectors.ARIA_DESCRIBEDBY, id)\r\n    tooltip.setAttribute(Selectors.ROLE, \"tooltip\")\r\n\r\n    // if (iOSMobile) {\r\n    //   trigger.addEventListener(Events.CLICK, this._render)\r\n    // }\r\n\r\n    trigger.addEventListener(Events.MOUSEENTER, this._render)\r\n    trigger.addEventListener(Events.FOCUS, this._render)\r\n  }\r\n\r\n  _getTargetAttr(id) {\r\n    return `[${Selectors.DATA_TARGET}=\"${id}\"]`\r\n  }\r\n\r\n  _getComputedLength(element, property) {\r\n    return parseInt(window.getComputedStyle(element)[property].slice(0, -2))\r\n  }\r\n\r\n  _isLeftOrRight() {\r\n    const classes = this._activeTooltip.classList\r\n    return classes.contains(Selectors.DROP_LEFT_CLASS) || classes.contains(Selectors.DROP_RIGHT_CLASS)\r\n  }\r\n}\r\n"],"file":"tooltip.js"}