/*!
  * @license MIT (https://github.com/geotrev/undernet/blob/master/LICENSE)
  * Undernet v3.1.0 (https://undernet.io)
  * Copyright 2017-2018 George Treviranus
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.undernet=e()}(this,function(){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,o){return e&&n(t.prototype,e),o&&n(t,o),t}function i(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?u(t):e}var d=16,h=9,v=38,f=40,A={NOT_VISUALLY_HIDDEN:":not(.is-visually-hidden)",FOCUSABLE_TAGS:["a","button","input","object","select","textarea","[tabindex]"],KEYBOARD_CLASS:"using-keyboard"},p="keydown",E="click",b=function(){function t(){var c=this;a(this,t),i(this,"_listenForKeyboard",function(t){var e=t.which===h,o=t.which===d||t.shiftKey,n=t.which===v,a=t.which===f;(e||o||n||a)&&(document.body.classList.add(A.KEYBOARD_CLASS),document.removeEventListener(p,c._listenForKeyboard),document.addEventListener(E,c._listenForClick),c.listeningForKeydown=!1)}),i(this,"_listenForClick",function(t){document.body.classList.remove(A.KEYBOARD_CLASS),document.removeEventListener(E,c._listenForClick),document.addEventListener(p,c._listenForKeyboard),c.listeningForKeydown=!0}),i(this,"_handleFocusTrapWithTab",function(t){var e=document.querySelector(c.focusContainerSelector),o=document.activeElement===e,n=document.activeElement===c.focusableFirstChild,a=document.activeElement===c.focusableLastChild,r=t.which===h,i=t.which===d||t.shiftKey;i&&r&&(n||o)?(t.preventDefault(),c.focusableLastChild.focus()):!i&&r&&a&&(t.preventDefault(),c.focusableFirstChild.focus())}),i(this,"_handleFocusTrapWithArrows",function(t){var e=document.activeElement===c.focusableFirstChild,o=document.activeElement===c.focusableLastChild,n=t.which===v,a=t.which===f;(n||a)&&(t.preventDefault(),e&&n?c.focusableLastChild.focus():o&&a?c.focusableFirstChild.focus():a?c._focusNextChild():n&&c._focusLastChild())}),this.focusContainerSelector="",this.focusableChildren=[],this.focusableFirstChild=null,this.focusableLastChild=null,this.listeningForKeydown=!1,this.trapFocusWithArrows=!1}return r(t,[{key:"captureFocus",value:function(t,e){this.focusContainerSelector=t,this.focusableChildren=this.getFocusableElements(this.focusContainerSelector),this.focusableFirstChild=this.focusableChildren[0],this.focusableLastChild=this.focusableChildren[this.focusableChildren.length-1],e?e.useArrows&&(this.trapFocusWithArrows=e.useArrows||this.trapFocusWithArrows,document.addEventListener(p,this._handleFocusTrapWithArrows)):document.addEventListener(p,this._handleFocusTrapWithTab)}},{key:"releaseFocus",value:function(){this.trapFocusWithArrows?(document.removeEventListener(p,this._handleFocusTrapWithArrows),this.trapFocusWithArrows=!1):document.removeEventListener(p,this._handleFocusTrapWithTab)}},{key:"enableFocusOutline",value:function(){document.addEventListener(p,this._listenForKeyboard)}},{key:"disableFocusOutline",value:function(){this.listeningForKeydown?document.removeEventListener(p,this._listenForKeyboard):document.removeEventListener(E,this._listenForClick)}},{key:"getElements",value:function(t){var e=document.querySelectorAll(t);return Array.apply(null,e)}},{key:"getFocusableElements",value:function(e){var t=A.FOCUSABLE_TAGS.map(function(t){return"".concat(e," ").concat(t).concat(A.NOT_VISUALLY_HIDDEN)});return this.getElements(t.join(", "))}},{key:"_focusNextChild",value:function(){for(var t=0;t<this.focusableChildren.length;t++)if(this.focusableChildren[t]===document.activeElement){this.focusableChildren[t+1].focus();break}}},{key:"_focusLastChild",value:function(){for(var t=0;t<this.focusableChildren.length;t++)if(this.focusableChildren[t]===document.activeElement){this.focusableChildren[t-1].focus();break}}}]),t}(),_=27,w="data-modal",m="data-modal-id",y="data-modal-button",e="no-scroll",C="data-visible",D="data-close",g="data-target",R="data-parent",L="aria-hidden",O="aria-modal",B="role",S="tabindex",k="keydown",I="click",T="Could not find [data-target] attribute associated with a [data-modal-button] element.",F="Could not find [data-parent] attribute associated with a [data-modal] element.",M=function(t){return"Could not find [data-modal-id='".concat(t,"'] associated with a [data-modal] element.")},t=function(t){function o(){var e;return a(this,o),i(u(u(e=l(this,s(o).call(this)))),"_render",function(t){return t.preventDefault(),e.activeModalButton=t.target,e.activeModalButton.getAttribute(g)?(e.activeModalId=e.activeModalButton.getAttribute(g),e.activeModalOverlayAttr="[".concat(m,'="').concat(e.activeModalId,'"]'),document.querySelector(e.activeModalOverlayAttr)?(e.activeModalOverlay=document.querySelector(e.activeModalOverlayAttr),e.activeModalSelector="".concat(e.activeModalOverlayAttr," ").concat(e.modalContainerAttr),e.activeModal=document.querySelector(e.activeModalSelector),e.activeModalCloseButtons=e.getElements("".concat(e.activeModalOverlayAttr," [").concat(w,"] [").concat(D,"]")),e.getFocusableElements(e.activeModalSelector).forEach(function(t){t.setAttribute(S,"0")}),e._handleScrollStop(),e.captureFocus(e.activeModalSelector),e.activeModalOverlay.setAttribute(L,"false"),e.activeModal.setAttribute(S,"-1"),e.activeModalOverlay.setAttribute(C,"true"),e.activeModal.focus(),e.activeModalOverlay.scrollTop=0,document.addEventListener(k,e._handleEscapeKeyPress),document.addEventListener(I,e._handleOverlayClick),void e.activeModalCloseButtons.forEach(function(t){t.addEventListener(I,e._handleClose)})):console.error(M(e.activeModalId))):console.error(T)}),i(u(u(e)),"_handleClose",function(t){t.preventDefault(),e.activeModalOverlay.setAttribute(C,"false"),e._handleReturnFocus(),e._handleScrollRestore(),e.releaseFocus(),e.activeModalOverlay.setAttribute(L,"true"),e.activeModal.removeAttribute(S),e.getFocusableElements(e.activeModalSelector).forEach(function(t){t.setAttribute(S,"-1")}),document.removeEventListener(k,e._handleEscapeKeyPress),document.removeEventListener(I,e._handleOverlayClick),e.activeModalCloseButtons.forEach(function(t){t.removeEventListener(I,e._handleClose)})}),i(u(u(e)),"_handleOverlayClick",function(t){t.target===e.activeModalOverlay&&e._handleClose(t)}),i(u(u(e)),"_handleEscapeKeyPress",function(t){t.which===_&&e._handleClose(t)}),e.modals=[],e.modalButtons=[],e.activeModalButton=null,e.activeModalOverlay=null,e.activeModal=null,e.activeModalId="",e.activeModalOverlayAttr="",e.activeModalSelector="",e.activeModalCloseButtons=[],e.modalContainerAttr="[".concat(w,"]"),e.closeButtonAttr="[".concat(w,"] [").concat(D,"]"),e}return c(o,b),r(o,[{key:"start",value:function(){var e=this;this.modals=this.getElements(this.modalContainerAttr),this.modalButtons=this.getElements("[".concat(y,"]")),this.getFocusableElements(this.modalContainerAttr).forEach(function(t){t.setAttribute(S,"-1")}),this.modals.length&&this.modals.forEach(function(t){e._setupModal(t)}),this.modalButtons.length&&this.modalButtons.forEach(function(t){t.addEventListener(I,e._render)})}},{key:"stop",value:function(){var e=this;this.modalButtons.forEach(function(t){t.removeEventListener(I,e._render)})}},{key:"_setupModal",value:function(t){var e,o;return t.getAttribute(R)?(e=t.getAttribute(R),document.querySelector("[".concat(m,"='").concat(e,"']"))?((o=document.querySelector("[".concat(m,"='").concat(e,"']"))).setAttribute(L,"true"),o.setAttribute(C,"false"),t.setAttribute(O,"true"),void t.setAttribute(B,"dialog")):console.error(M(e))):console.warn(F)}},{key:"_handleReturnFocus",value:function(){this.activeModalButton.setAttribute(S,"-1"),this.activeModalButton.focus(),this.activeModalButton.removeAttribute(S)}},{key:"_handleScrollRestore",value:function(){document.body.classList.remove(e),document.querySelector("html").classList.remove(e)}},{key:"_handleScrollStop",value:function(){document.body.classList.add(e),document.querySelector("html").classList.add(e)}}]),o}(),N=32,P="data-accordion",K="data-accordion-row",x="data-visible",W="data-target",q="data-toggle-multiple",H="data-parent",j="aria-expanded",U="aria-controls",X="aria-hidden",V="aria-labelledby",Y="tabindex",G="click",z="keydown",J={NO_VISIBLE_ERROR:function(t){return"Could not find parent with [data-visible] attribute associated with [data-target='".concat(t,"'].")},NO_ROW_ERROR:function(t){return"Could not find [data-accordion-row] associated with ".concat(t,".")},NO_HEADER_ID_ERROR:function(t){return"Could not find header tag associated with [data-target='".concat(t,"'].")},NO_PARENT_ERROR:function(t){return"Could not find [data-parent] associated with [data-target='".concat(t,"'].")},NO_CONTENT_ERROR:function(t){return"Could not accordion content block with [id] ".concat(t," associated with [data-target='").concat(t,"'].")}},Q=function(t){function e(){var o;return a(this,e),i(u(u(o=l(this,s(e).call(this)))),"_render",function(t){if(t.preventDefault(),o.activeButton=t.target,o.activeAccordionRowId=o.activeButton.getAttribute(W),o.activeRowAttr=o._getAccordionRowAttr(o.activeAccordionRowId),o.activeRow=document.querySelector(o.activeRowAttr),!o.activeButton.getAttribute(H))return console.error(J.NO_PARENT_ERROR(o.activeAccordionRowId));if(o.activeContainerId=o.activeButton.getAttribute(H),o.activeContainerAttr="[".concat(P,"='").concat(o.activeContainerId,"']"),!document.querySelector(o.activeContainerAttr))return console.error(J.NO_ACCORDION_ERROR(o.activeContainerId));o.activeContainer=document.querySelector(o.activeContainerAttr),o.activeContent=document.getElementById(o.activeAccordionRowId);var e=o.activeRow.getAttribute(x);o.activeButtonExpandState="true"===e?"false":"true",o.activeContentHiddenState="false"===o.activeButtonExpandState?"true":"false",o._closeAllIfToggleable(),o._toggleSelectedAccordion()}),i(u(u(o)),"_handleSpaceKeyPress",function(t){t.which===N&&o._render(t)}),o.accordionButtons=[],o.accordionContentsAttr="",o.accordionContents=[],o.activeContainer=null,o.activeButton=null,o.activeAccordionRowId="",o.activeRowAttr="",o.activeRow="",o.activeContainerId="",o.activeContainerAttr="",o.activeContent=null,o.activeButtonExpandState="",o.activeContentHiddenState="",o}return c(e,b),r(e,[{key:"start",value:function(){var e=this;this.accordionButtons=this.getElements("[".concat(P,"] [").concat(W,"]")),this.accordionButtons.length&&this.accordionButtons.forEach(function(t){e._setupAccordion(t),t.addEventListener(G,e._render),t.addEventListener(z,e._handleSpaceKeyPress)})}},{key:"stop",value:function(){var e=this;this.accordionButtons.forEach(function(t){t.removeEventListener(G,e._render),t.removeEventListener(z,e._handleSpaceKeyPress)})}},{key:"_setupAccordion",value:function(t){var e=t.getAttribute(W);if(!document.getElementById(e))return console.error(J.NO_CONTENT_ERROR(e));var o=document.getElementById(e),n=this._getAccordionRowAttr(e);if(!document.querySelector(n))return console.error(J.NO_ROW_ERROR(e));var a=document.querySelector(n),r=this._getPossibleAccordionHeaderAttrs(n),i=this.getElements(r)[0];i&&i.id||console.error(J.NO_HEADER_ID_ERROR(e));var c=this.getFocusableElements("#".concat(o.id));if(t.setAttribute(U,e),o.setAttribute(V,i.id),!a.getAttribute(x))return console.error(J.NO_VISIBLE_ERROR(e));"true"===a.getAttribute(x)?(o.style.maxHeight="".concat(o.scrollHeight,"px"),t.setAttribute(j,"true"),o.setAttribute(X,"false"),c.forEach(function(t){t.setAttribute(Y,"0")})):(t.setAttribute(j,"false"),o.setAttribute(X,"true"),c.forEach(function(t){t.setAttribute(Y,"-1")}))}},{key:"_getPossibleAccordionHeaderAttrs",value:function(t){return"".concat(t," h1, ").concat(t," h2, ").concat(t," h3, ").concat(t," h4, ").concat(t," h5, ").concat(t," h6")}},{key:"_getAccordionRowAttr",value:function(t){return"[".concat(K,"='").concat(t,"']")}},{key:"_closeAllIfToggleable",value:function(){var e=this;if(!this.activeContainer.hasAttribute(q)){var t="".concat(this.activeContainerAttr," [").concat(X,"]"),o=this.getElements("".concat(this.activeContainerAttr," [").concat(x,"]")),n=this.getElements(t),a=this.getElements("".concat(this.activeContainerAttr," [").concat(W,"]"));n.forEach(function(t){t!==e.activeContent&&(t.style.maxHeight=null)}),this.getFocusableElements(t).forEach(function(t){t.setAttribute(Y,"-1")}),this._toggleAttributeInCollection(o,x,"true","false"),this._toggleAttributeInCollection(a,j,"true","false"),this._toggleAttributeInCollection(n,X,"false","true")}}},{key:"_toggleSelectedAccordion",value:function(){var o=this;this.activeRow.setAttribute(x,this.activeButtonExpandState),this.activeButton.setAttribute(j,this.activeButtonExpandState),this.activeContent.setAttribute(X,this.activeContentHiddenState);var t="#".concat(this.activeAccordionRowId);this.getFocusableElements(t).forEach(function(t){var e="true"===o.activeButtonExpandState?"0":"-1";t.setAttribute(Y,e)}),this.activeContent.style.maxHeight?this.activeContent.style.maxHeight=null:this.activeContent.style.maxHeight="".concat(this.activeContent.scrollHeight,"px")}},{key:"_toggleAttributeInCollection",value:function(t,e,o,n){t.forEach(function(t){t.hasAttribute(e,o)&&t.setAttribute(e,n)})}}]),e}(),Z=9,$=16,tt=27,et=38,ot=40,nt={DATA_DROPDOWN:"data-dropdown",DATA_TARGET:"data-target",DATA_PARENT:"data-parent",DATA_VISIBLE:"data-visible",TABINDEX:"tabindex",ARIA_HASPOPUP:"aria-haspopup",ARIA_CONTROLS:"aria-controls",ARIA_LABELLEDBY:"aria-labelledby",ARIA_EXPANDED:"aria-expanded",ROLE:"role"},at="keydown",rt="click",it="Could not find dropdown button's [data-parent] attribute.",ct=function(t){return"Could not find dropdown container associated with ".concat(t,".")},st=function(t){return"Could not find menu associated with ".concat(t,".")},ut=function(t){function e(){var n;return a(this,e),i(u(u(n=l(this,s(e).call(this)))),"_render",function(t,e){return e||t.preventDefault(),t.stopPropagation(),n.activeDropdownButton&&(n.allowFocusReturn=!1,n._handleClose(t),n.allowFocusReturn=!0),n.activeDropdownButton=t.target,n.activeDropdownButton.getAttribute(nt.DATA_PARENT)?(n.activeDropdownId=n.activeDropdownButton.getAttribute(nt.DATA_PARENT),n.activeDropdownAttr="[".concat(nt.DATA_DROPDOWN,'="').concat(n.activeDropdownId,'"]'),document.querySelector(n.activeDropdownAttr)?(n.activeDropdown=document.querySelector(n.activeDropdownAttr),n.activeDropdownMenuId=n.activeDropdownButton.getAttribute(nt.DATA_TARGET),n.activeDropdownMenu=document.getElementById(n.activeDropdownMenuId),n.activeDropdownButton.setAttribute(nt.ARIA_EXPANDED,"true"),n.activeDropdown.setAttribute(nt.DATA_VISIBLE,"true"),n.activeDropdownButton.removeEventListener(rt,n._render),n.activeDropdownButton.addEventListener(rt,n._handleClose),document.addEventListener(at,n._handleEscapeKeyPress),document.addEventListener(rt,n._handleOffMenuClick),n.activeDropdownLinks=n._getDropdownLinks(n.activeDropdownAttr),n.firstDropdownLink=n.activeDropdownLinks[0],n.lastDropdownLink=n.activeDropdownLinks[n.activeDropdownLinks.length-1],n.firstDropdownLink.addEventListener(at,n._handleFirstTabClose),n.lastDropdownLink.addEventListener(at,n._handleLastTabClose),e&&e===et?n.lastDropdownLink.focus():n.firstDropdownLink.focus(),n.activeDropdownLinks.forEach(function(t){t.setAttribute(nt.TABINDEX,"0"),t.addEventListener(rt,n._handleClose)}),void n.captureFocus("".concat(n.activeDropdownAttr," > ul"),{useArrows:!0})):ct(n.activeDropdownAttr)):it}),i(u(u(n)),"_handleFirstTabClose",function(t){var e=t.which===$||t.shiftKey,o=t.which===Z;e&&o&&n._handleClose(t)}),i(u(u(n)),"_handleLastTabClose",function(t){var e=t.which===$||t.shiftKey;t.which===Z&&!e&&n._handleClose(t)}),i(u(u(n)),"_renderWithKeys",function(t){t.which!==et&&t.which!==ot||n._render(t,t.which)}),i(u(u(n)),"_handleClose",function(t){t.preventDefault(),n.releaseFocus(),n.activeDropdownButton.setAttribute(nt.ARIA_EXPANDED,"false"),n.activeDropdown.setAttribute(nt.DATA_VISIBLE,"false"),n.activeDropdownLinks.forEach(function(t){t.setAttribute(nt.TABINDEX,"-1"),t.removeEventListener(rt,n._handleClose)}),n.activeDropdownButton.removeEventListener(rt,n._handleClose),n.activeDropdownButton.addEventListener(rt,n._render),document.removeEventListener(at,n._handleEscapeKeyPress),document.removeEventListener(rt,n._handleOffMenuClick),n.allowFocusReturn&&n._handleReturnFocus()}),i(u(u(n)),"_handleEscapeKeyPress",function(t){t.which===tt&&n._handleClose(t)}),i(u(u(n)),"_handleOffMenuClick",function(t){t.target!==n.activeDropdownButton&&t.target!==n.activeDropdownMenu&&n._handleClose(t)}),n.activeDropdownButton=null,n.activeDropdown=null,n.activeDropdownMenu=null,n.activeDropdownLinks=[],n.allowFocusReturn=!0,n.activeDropdownId="",n.activeDropdownAttr="",n.activeDropdownMenuId="",n.dropdownButtons=[],n.dropdowns=[],n.dropdownTargetAttr="[".concat(nt.DATA_TARGET,"]"),n.dropdownButtonAttr="[".concat(nt.DATA_DROPDOWN,"] > ").concat(n.dropdownTargetAttr),n}return c(e,b),r(e,[{key:"start",value:function(){var e=this;this.dropdowns=this.getElements("[".concat(nt.DATA_DROPDOWN,"]")),this.dropdownButtons=this.getElements(this.dropdownButtonAttr),this.dropdowns.length&&this.dropdowns.forEach(function(t){return e._setupDropdown(t)}),this.dropdownButtons.forEach(function(t){t.addEventListener(rt,e._render),t.addEventListener(at,e._renderWithKeys)})}},{key:"stop",value:function(){var e=this;this.dropdownButtons.forEach(function(t){t.removeEventListener(rt,e._render),t.removeEventListener(at,e._renderWithKeys)})}},{key:"_handleReturnFocus",value:function(){this.activeDropdownButton.setAttribute(nt.TAB_INDEX,"-1"),this.activeDropdownButton.focus(),this.activeDropdownButton.removeAttribute(nt.TAB_INDEX)}},{key:"_getDropdownLinks",value:function(t){return this.getElements("".concat(t," > ul > li > a, ").concat(t," > ul > li > button"))}},{key:"_setupDropdown",value:function(t){var e=t.getAttribute(nt.DATA_DROPDOWN),o="[".concat(nt.DATA_DROPDOWN,'="').concat(e,'"]'),n="".concat(o," > ul > li");if(!document.querySelector("".concat(o," > ul")))return st(o);var a=document.querySelector("".concat(o," > ul")),r=document.querySelector("".concat(o," > ").concat(this.dropdownTargetAttr));r.setAttribute(nt.ARIA_CONTROLS,a.id),r.setAttribute(nt.ARIA_HASPOPUP,"true"),r.setAttribute(nt.ARIA_EXPANDED,"false"),a.setAttribute(nt.ARIA_LABELLEDBY,r.id),this.getElements(n).forEach(function(t){return t.setAttribute(nt.ROLE,"none")}),this._getDropdownLinks(o).forEach(function(t){t.setAttribute(nt.ROLE,"menuitem"),t.setAttribute(nt.TABINDEX,"-1")})}}]),e}(),Undernet={Modals:new t,Accordions:new Q,Dropdowns:new ut,Utils:new b,start:function(){Undernet.Modals.start(),Undernet.Accordions.start(),Undernet.Dropdowns.start(),Undernet.Utils.enableFocusOutline()},stop:function(){Undernet.Modals.stop(),Undernet.Accordions.stop(),Undernet.Dropdowns.stop(),Undernet.Utils.disableFocusOutline()}};return window.Undernet=Undernet});
//# sourceMappingURL=undernet.bundle.min.js.map
