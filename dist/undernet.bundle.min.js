/*!
  * @license MIT (https://github.com/geotrev/undernet/blob/master/LICENSE)
  * Undernet v3.0.3 (https://undernet.io)
  * Copyright 2017-2018 George Treviranus
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.undernet=e()}(this,function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?c(t):e}var u=16,d=9,h=38,v=40,f={NOT_VISUALLY_HIDDEN:":not(.is-visually-hidden)",FOCUSABLE_TAGS:["a","button","input","object","select","textarea","[tabindex]"],KEYBOARD_CLASS:"using-keyboard"},A="keydown",_="click",b=function(){function t(){n(this,t),this._handleFocusTrapWithTab=this._handleFocusTrapWithTab.bind(this),this._handleFocusTrapWithArrows=this._handleFocusTrapWithArrows.bind(this),this._listenForKeyboard=this._listenForKeyboard.bind(this),this._listenForClick=this._listenForClick.bind(this),this.focusContainerSelector="",this.focusableChildren=[],this.focusableFirstChild=null,this.focusableLastChild=null,this.listeningForKeydown=!1,this.trapFocusWithArrows=!1}return i(t,[{key:"captureFocus",value:function(t,e){this.focusContainerSelector=t,this.focusableChildren=this._getFocusableElements(this.focusContainerSelector),this.focusableFirstChild=this.focusableChildren[0],this.focusableLastChild=this.focusableChildren[this.focusableChildren.length-1],e?e.useArrows&&(this.trapFocusWithArrows=e.useArrows||this.trapFocusWithArrows,document.addEventListener(A,this._handleFocusTrapWithArrows)):document.addEventListener(A,this._handleFocusTrapWithTab)}},{key:"releaseFocus",value:function(){this.trapFocusWithArrows?(document.removeEventListener(A,this._handleFocusTrapWithArrows),this.trapFocusWithArrows=!1):document.removeEventListener(A,this._handleFocusTrapWithTab)}},{key:"enableFocusOutline",value:function(){document.addEventListener(A,this._listenForKeyboard)}},{key:"disableFocusOutline",value:function(){this.listeningForKeydown?document.removeEventListener(A,this._listenForKeyboard):document.removeEventListener(_,this._listenForClick)}},{key:"_listenForKeyboard",value:function(t){var e=t.which===d,n=t.which===u||t.shiftKey,o=t.which===h,i=t.which===v;(e||n||o||i)&&(document.body.classList.add(f.KEYBOARD_CLASS),document.removeEventListener(A,this._listenForKeyboard),document.addEventListener(_,this._listenForClick),this.listeningForKeydown=!1)}},{key:"_listenForClick",value:function(t){document.body.classList.remove(f.KEYBOARD_CLASS),document.removeEventListener(_,this._listenForClick),document.addEventListener(A,this._listenForKeyboard),this.listeningForKeydown=!0}},{key:"_getElements",value:function(t){var e=document.querySelectorAll(t);return Array.apply(null,e)}},{key:"_getFocusableElements",value:function(e){var t=f.FOCUSABLE_TAGS.map(function(t){return"".concat(e," ").concat(t).concat(f.NOT_VISUALLY_HIDDEN)});return this._getElements(t.join(", "))}},{key:"_handleFocusTrapWithTab",value:function(t){var e=document.querySelector(this.focusContainerSelector),n=document.activeElement===e,o=document.activeElement===this.focusableFirstChild,i=document.activeElement===this.focusableLastChild,a=t.which===d,r=t.which===u||t.shiftKey;r&&a&&(o||n)?(t.preventDefault(),this.focusableLastChild.focus()):!r&&a&&i&&(t.preventDefault(),this.focusableFirstChild.focus())}},{key:"_handleFocusTrapWithArrows",value:function(t){var e=document.activeElement===this.focusableFirstChild,n=document.activeElement===this.focusableLastChild,o=t.which===h,i=t.which===v;(o||i)&&(t.preventDefault(),e&&o?this.focusableLastChild.focus():n&&i?this.focusableFirstChild.focus():i?this._focusNextChild():o&&this._focusLastChild())}},{key:"_focusNextChild",value:function(){for(var t=0;t<this.focusableChildren.length;t++)if(this.focusableChildren[t]===document.activeElement){this.focusableChildren[t+1].focus();break}}},{key:"_focusLastChild",value:function(){for(var t=0;t<this.focusableChildren.length;t++)if(this.focusableChildren[t]===document.activeElement){this.focusableChildren[t-1].focus();break}}}]),t}(),p=27,E="data-modal",w="data-modal-id",y="data-modal-button",m="no-scroll",C="data-visible",D="data-close",g="data-target",R="data-parent",L="aria-hidden",O="aria-modal",k="role",B="tabindex",S="keydown",T="click",F="Could not find [data-target] attribute associated with a [data-modal-button] element.",I="Could not find [data-parent] attribute associated with a [data-modal] element.",M=function(t){return"Could not find [data-modal-id='".concat(t,"'] associated with a [data-modal] element.")},t=function(t){function e(){var t;return n(this,e),(t=l(this,r(e).call(this)))._render=t._render.bind(c(c(t))),t._handleClose=t._handleClose.bind(c(c(t))),t._handleEscapeKeyPress=t._handleEscapeKeyPress.bind(c(c(t))),t._handleOverlayClick=t._handleOverlayClick.bind(c(c(t))),t.modals=[],t.modalButtons=[],t.activeModalButton=null,t.activeModalOverlay=null,t.activeModal=null,t.activeModalId="",t.activeModalOverlayAttr="",t.activeModalSelector="",t.activeModalCloseButtons=[],t.modalContainerAttr="[".concat(E,"]"),t.closeButtonAttr="[".concat(E,"] [").concat(D,"]"),t}return a(e,b),i(e,[{key:"start",value:function(){var e=this;this.modals=this._getElements(this.modalContainerAttr),this.modalButtons=this._getElements("[".concat(y,"]")),this._getFocusableElements(this.modalContainerAttr).forEach(function(t){t.setAttribute(B,"-1")}),this.modals.length&&this.modals.forEach(function(t){e._setupModal(t)}),this.modalButtons.length&&this.modalButtons.forEach(function(t){t.addEventListener(T,e._render)})}},{key:"stop",value:function(){var e=this;this.modalButtons.forEach(function(t){t.removeEventListener(T,e._render)})}},{key:"_render",value:function(t){var e=this;return t.preventDefault(),this.activeModalButton=t.target,this.activeModalButton.getAttribute(g)?(this.activeModalId=this.activeModalButton.getAttribute(g),this.activeModalOverlayAttr="[".concat(w,'="').concat(this.activeModalId,'"]'),document.querySelector(this.activeModalOverlayAttr)?(this.activeModalOverlay=document.querySelector(this.activeModalOverlayAttr),this.activeModalSelector="".concat(this.activeModalOverlayAttr," ").concat(this.modalContainerAttr),this.activeModal=document.querySelector(this.activeModalSelector),this.activeModalCloseButtons=this._getElements("".concat(this.activeModalOverlayAttr," [").concat(E,"] [").concat(D,"]")),this._getFocusableElements(this.activeModalSelector).forEach(function(t){t.setAttribute(B,"0")}),this._handleScrollStop(),this.captureFocus(this.activeModalSelector),this.activeModalOverlay.setAttribute(L,"false"),this.activeModal.setAttribute(B,"-1"),this.activeModalOverlay.setAttribute(C,"true"),this.activeModal.focus(),this.activeModalOverlay.scrollTop=0,document.addEventListener(S,this._handleEscapeKeyPress),document.addEventListener(T,this._handleOverlayClick),void this.activeModalCloseButtons.forEach(function(t){t.addEventListener(T,e._handleClose)})):console.error(M(this.activeModalId))):console.error(F)}},{key:"_setupModal",value:function(t){var e,n;return t.getAttribute(R)?(e=t.getAttribute(R),document.querySelector("[".concat(w,"='").concat(e,"']"))?((n=document.querySelector("[".concat(w,"='").concat(e,"']"))).setAttribute(L,"true"),n.setAttribute(C,"false"),t.setAttribute(O,"true"),void t.setAttribute(k,"dialog")):console.error(M(e))):console.warn(I)}},{key:"_handleClose",value:function(t){var e=this;t.preventDefault(),this.activeModalOverlay.setAttribute(C,"false"),this._handleReturnFocus(),this._handleScrollRestore(),this.releaseFocus(),this.activeModalOverlay.setAttribute(L,"true"),this.activeModal.removeAttribute(B),this._getFocusableElements(this.activeModalSelector).forEach(function(t){t.setAttribute(B,"-1")}),document.removeEventListener(S,this._handleEscapeKeyPress),document.removeEventListener(T,this._handleOverlayClick),this.activeModalCloseButtons.forEach(function(t){t.removeEventListener(T,e._handleClose)})}},{key:"_handleOverlayClick",value:function(t){t.target===this.activeModalOverlay&&this._handleClose(t)}},{key:"_handleEscapeKeyPress",value:function(t){t.which===p&&this._handleClose(t)}},{key:"_handleReturnFocus",value:function(){this.activeModalButton.setAttribute(B,"-1"),this.activeModalButton.focus(),this.activeModalButton.removeAttribute(B)}},{key:"_handleScrollRestore",value:function(){document.body.classList.remove(m),document.querySelector("html").classList.remove(m)}},{key:"_handleScrollStop",value:function(){document.body.classList.add(m),document.querySelector("html").classList.add(m)}}]),e}(),N=32,P="data-accordion",K="data-accordion-row",W="data-visible",x="data-target",q="data-toggle-multiple",H="data-parent",X="aria-expanded",j="aria-controls",U="aria-hidden",V="aria-labelledby",Y="tabindex",G="click",z="keydown",J={NO_VISIBLE_ERROR:function(t){return"Could not find parent with [data-visible] attribute associated with [data-target='".concat(t,"'].")},NO_ROW_ERROR:function(t){return"Could not find [data-accordion-row] associated with ".concat(t,".")},NO_HEADER_ID_ERROR:function(t){return"Could not find header tag associated with [data-target='".concat(t,"'].")},NO_PARENT_ERROR:function(t){return"Could not find [data-parent] associated with [data-target='".concat(t,"'].")},NO_CONTENT_ERROR:function(t){return"Could not accordion content block with [id] ".concat(t," associated with [data-target='").concat(t,"'].")}},e=function(t){function e(){var t;return n(this,e),(t=l(this,r(e).call(this)))._render=t._render.bind(c(c(t))),t._handleSpaceKeyPress=t._handleSpaceKeyPress.bind(c(c(t))),t.accordionButtons=[],t.accordionContentsAttr="",t.accordionContents=[],t.activeContainer=null,t.activeButton=null,t.activeAccordionRowId="",t.activeRowAttr="",t.activeRow="",t.activeContainerId="",t.activeContainerAttr="",t.activeContent=null,t.activeButtonExpandState="",t.activeContentHiddenState="",t}return a(e,b),i(e,[{key:"start",value:function(){var e=this;this.accordionButtons=this._getElements("[".concat(P,"] [").concat(x,"]")),this.accordionButtons.length&&this.accordionButtons.forEach(function(t){e._setupAccordion(t),t.addEventListener(G,e._render),t.addEventListener(z,e._handleSpaceKeyPress)})}},{key:"stop",value:function(){var e=this;this.accordionButtons.forEach(function(t){t.removeEventListener(G,e._render),t.removeEventListener(z,e._handleSpaceKeyPress)})}},{key:"_setupAccordion",value:function(t){var e=t.getAttribute(x);if(!document.getElementById(e))return console.error(J.NO_CONTENT_ERROR(e));var n=document.getElementById(e),o=this._getAccordionRowAttr(e);if(!document.querySelector(o))return console.error(J.NO_ROW_ERROR(e));var i=document.querySelector(o),a=this._getPossibleAccordionHeaderAttrs(o),r=this._getElements(a)[0];r&&r.id||console.error(J.NO_HEADER_ID_ERROR(e));var s=this._getFocusableElements("#".concat(n.id));if(t.setAttribute(j,e),n.setAttribute(V,r.id),!i.getAttribute(W))return console.error(J.NO_VISIBLE_ERROR(e));"true"===i.getAttribute(W)?(n.style.maxHeight="".concat(n.scrollHeight,"px"),t.setAttribute(X,"true"),n.setAttribute(U,"false"),s.forEach(function(t){t.setAttribute(Y,"0")})):(t.setAttribute(X,"false"),n.setAttribute(U,"true"),s.forEach(function(t){t.setAttribute(Y,"-1")}))}},{key:"_getPossibleAccordionHeaderAttrs",value:function(t){return"".concat(t," h1, ").concat(t," h2, ").concat(t," h3, ").concat(t," h4, ").concat(t," h5, ").concat(t," h6")}},{key:"_getAccordionRowAttr",value:function(t){return"[".concat(K,"='").concat(t,"']")}},{key:"_render",value:function(t){if(t.preventDefault(),this.activeButton=t.target,this.activeAccordionRowId=this.activeButton.getAttribute(x),this.activeRowAttr=this._getAccordionRowAttr(this.activeAccordionRowId),this.activeRow=document.querySelector(this.activeRowAttr),!this.activeButton.getAttribute(H))return console.error(J.NO_PARENT_ERROR(this.activeAccordionRowId));if(this.activeContainerId=this.activeButton.getAttribute(H),this.activeContainerAttr="[".concat(P,"='").concat(this.activeContainerId,"']"),!document.querySelector(this.activeContainerAttr))return console.error(J.NO_ACCORDION_ERROR(this.activeContainerId));this.activeContainer=document.querySelector(this.activeContainerAttr),this.activeContent=document.getElementById(this.activeAccordionRowId);var e=this.activeRow.getAttribute(W);this.activeButtonExpandState="true"===e?"false":"true",this.activeContentHiddenState="false"===this.activeButtonExpandState?"true":"false",this._closeAllIfToggleable(),this._toggleSelectedAccordion()}},{key:"_handleSpaceKeyPress",value:function(t){t.which===N&&this._render(t)}},{key:"_closeAllIfToggleable",value:function(){var e=this;if(!this.activeContainer.hasAttribute(q)){var t="".concat(this.activeContainerAttr," [").concat(U,"]"),n=this._getElements("".concat(this.activeContainerAttr," [").concat(W,"]")),o=this._getElements(t),i=this._getElements("".concat(this.activeContainerAttr," [").concat(x,"]"));o.forEach(function(t){t!==e.activeContent&&(t.style.maxHeight=null)}),this._getFocusableElements(t).forEach(function(t){t.setAttribute(Y,"-1")}),this._toggleAttributeInCollection(n,W,"true","false"),this._toggleAttributeInCollection(i,X,"true","false"),this._toggleAttributeInCollection(o,U,"false","true")}}},{key:"_toggleSelectedAccordion",value:function(){var n=this;this.activeRow.setAttribute(W,this.activeButtonExpandState),this.activeButton.setAttribute(X,this.activeButtonExpandState),this.activeContent.setAttribute(U,this.activeContentHiddenState);var t="#".concat(this.activeAccordionRowId);this._getFocusableElements(t).forEach(function(t){var e="true"===n.activeButtonExpandState?"0":"-1";t.setAttribute(Y,e)}),this.activeContent.style.maxHeight?this.activeContent.style.maxHeight=null:this.activeContent.style.maxHeight="".concat(this.activeContent.scrollHeight,"px")}},{key:"_toggleAttributeInCollection",value:function(t,e,n,o){t.forEach(function(t){t.hasAttribute(e,n)&&t.setAttribute(e,o)})}}]),e}(),Q=9,Z=16,$=27,tt=38,et=40,nt={DATA_DROPDOWN:"data-dropdown",DATA_TARGET:"data-target",DATA_PARENT:"data-parent",DATA_VISIBLE:"data-visible",TABINDEX:"tabindex",ARIA_HASPOPUP:"aria-haspopup",ARIA_CONTROLS:"aria-controls",ARIA_LABELLEDBY:"aria-labelledby",ARIA_EXPANDED:"aria-expanded",ROLE:"role"},ot="keydown",it="click",at="Could not find dropdown button's [data-parent] attribute.",rt=function(t){return"Could not find dropdown container associated with ".concat(t,".")},st=function(t){return"Could not find menu associated with ".concat(t,".")},ct=function(t){function e(){var t;return n(this,e),(t=l(this,r(e).call(this)))._render=t._render.bind(c(c(t))),t._renderWithKeys=t._renderWithKeys.bind(c(c(t))),t._handleClose=t._handleClose.bind(c(c(t))),t._handleEscapeKeyPress=t._handleEscapeKeyPress.bind(c(c(t))),t._handleOffMenuClick=t._handleOffMenuClick.bind(c(c(t))),t._handleFirstTabClose=t._handleFirstTabClose.bind(c(c(t))),t._handleLastTabClose=t._handleLastTabClose.bind(c(c(t))),t.activeDropdownButton=null,t.activeDropdown=null,t.activeDropdownMenu=null,t.activeDropdownLinks=[],t.allowFocusReturn=!0,t.activeDropdownId="",t.activeDropdownAttr="",t.activeDropdownMenuId="",t.dropdownButtons=[],t.dropdowns=[],t.dropdownTargetAttr="[".concat(nt.DATA_TARGET,"]"),t.dropdownButtonAttr="[".concat(nt.DATA_DROPDOWN,"] > ").concat(t.dropdownTargetAttr),t}return a(e,b),i(e,[{key:"start",value:function(){var e=this;this.dropdowns=this._getElements("[".concat(nt.DATA_DROPDOWN,"]")),this.dropdownButtons=this._getElements(this.dropdownButtonAttr),this.dropdowns.length&&this.dropdowns.forEach(function(t){return e._setupDropdown(t)}),this.dropdownButtons.forEach(function(t){t.addEventListener(it,e._render),t.addEventListener(ot,e._renderWithKeys)})}},{key:"stop",value:function(){var e=this;this.dropdownButtons.forEach(function(t){t.removeEventListener(it,e._render),t.removeEventListener(ot,e._renderWithKeys)})}},{key:"_render",value:function(t,e){var n=this;return e||t.preventDefault(),t.stopPropagation(),this.activeDropdownButton&&(this.allowFocusReturn=!1,this._handleClose(t),this.allowFocusReturn=!0),this.activeDropdownButton=t.target,this.activeDropdownButton.getAttribute(nt.DATA_PARENT)?(this.activeDropdownId=this.activeDropdownButton.getAttribute(nt.DATA_PARENT),this.activeDropdownButton.setAttribute(nt.ARIA_EXPANDED,"true"),this.activeDropdownAttr="[".concat(nt.DATA_DROPDOWN,'="').concat(this.activeDropdownId,'"]'),document.querySelector(this.activeDropdownAttr)?(this.activeDropdown=document.querySelector(this.activeDropdownAttr),this.activeDropdownMenuId=this.activeDropdownButton.getAttribute(nt.DATA_TARGET),this.activeDropdownMenu=document.getElementById(this.activeDropdownMenuId),this.activeDropdownButton.setAttribute(nt.ARIA_EXPANDED,"true"),this.activeDropdown.setAttribute(nt.DATA_VISIBLE,"true"),this.activeDropdownButton.removeEventListener(it,this._render),this.activeDropdownButton.addEventListener(it,this._handleClose),document.addEventListener(ot,this._handleEscapeKeyPress),document.addEventListener(it,this._handleOffMenuClick),this.activeDropdownLinks=this._getDropdownButtons(this.activeDropdownAttr),this.firstDropdownLink=this.activeDropdownLinks[0],this.lastDropdownLink=this.activeDropdownLinks[this.activeDropdownLinks.length-1],this.firstDropdownLink.addEventListener(ot,this._handleFirstTabClose),this.lastDropdownLink.addEventListener(ot,this._handleLastTabClose),e&&e===tt?this.lastDropdownLink.focus():this.firstDropdownLink.focus(),this.activeDropdownLinks.forEach(function(t){t.setAttribute(nt.TABINDEX,"0"),t.addEventListener(it,n._handleClose)}),void this.captureFocus("".concat(this.activeDropdownAttr," > ul"),{useArrows:!0})):rt(this.activeDropdownAttr)):at}},{key:"_handleFirstTabClose",value:function(t){var e=t.which===Z||t.shiftKey,n=t.which===Q;e&&n&&this._handleClose(t)}},{key:"_handleLastTabClose",value:function(t){var e=t.which===Z||t.shiftKey;t.which===Q&&!e&&this._handleClose(t)}},{key:"_renderWithKeys",value:function(t){t.which!==tt&&t.which!==et||this._render(t,t.which)}},{key:"_handleClose",value:function(t){var e=this;t.preventDefault(),this.releaseFocus(),this.activeDropdownButton.setAttribute(nt.ARIA_EXPANDED,"false"),this.activeDropdown.setAttribute(nt.DATA_VISIBLE,"false"),this.activeDropdownLinks.forEach(function(t){t.setAttribute(nt.TABINDEX,"-1"),t.removeEventListener(it,e._handleClose)}),this.activeDropdownButton.removeEventListener(it,this._handleClose),this.activeDropdownButton.addEventListener(it,this._render),document.removeEventListener(ot,this._handleEscapeKeyPress),document.removeEventListener(it,this._handleOffMenuClick),this.allowFocusReturn&&this._handleReturnFocus()}},{key:"_handleEscapeKeyPress",value:function(t){t.which===$&&this._handleClose(t)}},{key:"_handleOffMenuClick",value:function(t){t.target!==this.activeDropdownButton&&t.target!==this.activeDropdownMenu&&this._handleClose(t)}},{key:"_handleReturnFocus",value:function(){this.activeDropdownButton.setAttribute(nt.TAB_INDEX,"-1"),this.activeDropdownButton.focus(),this.activeDropdownButton.removeAttribute(nt.TAB_INDEX)}},{key:"_getDropdownButtons",value:function(t){return this._getElements("".concat(t," > ul > li > a, ").concat(t," > ul > li > button"))}},{key:"_setupDropdown",value:function(t){var e=t.getAttribute(nt.DATA_DROPDOWN),n="[".concat(nt.DATA_DROPDOWN,'="').concat(e,'"]'),o="".concat(n," > ul > li");if(!document.querySelector("".concat(n," > ul")))return st(n);var i=document.querySelector("".concat(n," > ul")),a=document.querySelector("".concat(n," > ").concat(this.dropdownTargetAttr));a.setAttribute(nt.ARIA_CONTROLS,i.id),a.setAttribute(nt.ARIA_HASPOPUP,"true"),a.setAttribute(nt.ARIA_EXPANDED,"false"),i.setAttribute(nt.ARIA_LABELLEDBY,a.id),this._getElements(o).forEach(function(t){return t.setAttribute(nt.ROLE,"none")}),this._getDropdownButtons(n).forEach(function(t){t.setAttribute(nt.ROLE,"menuitem"),t.setAttribute(nt.TABINDEX,"-1")})}}]),e}(),Undernet={Modals:new t,Accordions:new e,Dropdowns:new ct,Utils:new b,start:function(){Undernet.Modals.start(),Undernet.Accordions.start(),Undernet.Dropdowns.start(),Undernet.Utils.enableFocusOutline()},stop:function(){Undernet.Modals.stop(),Undernet.Accordions.stop(),Undernet.Dropdowns.stop(),Undernet.Utils.disableFocusOutline()}};return window.Undernet=Undernet});
//# sourceMappingURL=undernet.bundle.min.js.map
