/*!
  * @license MIT (https://github.com/geotrev/undernet/blob/master/LICENSE)
  * Undernet v2.3.0 (https://undernet.io)
  * Copyright 2017-2018 George Treviranus
  */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.undernet=e()}(this,function(){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function i(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function a(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function r(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?r(t):e}var u=16,d=9,h={FOCUSABLE_SELECTOR:":not(.is-visually-hidden)",FOCUSABLE_TAGS:["a","button","input","object","select","textarea","[tabindex]"],KEYBOARD_CLASS:"using-keyboard"},v="keydown",f="click",b=function(){function t(){n(this,t),this._handleFocusTrap=this._handleFocusTrap.bind(this),this._listenForKeyboard=this._listenForKeyboard.bind(this),this._listenForClick=this._listenForClick.bind(this)}return i(t,[{key:"captureFocus",value:function(t){this.focusContainerSelector=t;var e=this._getFocusableElements(this.focusContainerSelector);this.focusableFirstChild=e[0],this.focusableLastChild=e[e.length-1],document.addEventListener(v,this._handleFocusTrap)}},{key:"releaseFocus",value:function(){document.removeEventListener(v,this._handleFocusTrap)}},{key:"enableFocusOutline",value:function(){document.addEventListener(v,this._listenForKeyboard)}},{key:"disableFocusOutline",value:function(){document.removeEventListener(v,this._listenForKeyboard),document.removeEventListener(f,this.__listenForClick)}},{key:"_listenForKeyboard",value:function(t){var e=t.which===d,n=t.which===u||t.shiftKey;(e||n)&&(document.body.classList.add(h.KEYBOARD_CLASS),document.removeEventListener(v,this._listenForKeyboard),document.addEventListener(f,this._listenForClick))}},{key:"_listenForClick",value:function(t){document.body.classList.remove(h.KEYBOARD_CLASS),document.removeEventListener(f,this._listenForClick),document.addEventListener(v,this._listenForKeyboard)}},{key:"_getElements",value:function(t){var e=document.querySelectorAll(t);return Array.apply(null,e)}},{key:"_getFocusableElements",value:function(e){var n=[];return h.FOCUSABLE_TAGS.map(function(t){return n.push("".concat(e," ").concat(t).concat(h.FOCUSABLE_SELECTOR))}),this._getElements(n.join(", "))}},{key:"_handleFocusTrap",value:function(t){var e=document.activeElement,n=e===document.querySelector(this.focusContainerSelector),o=e===this.focusableFirstChild,i=e===this.focusableLastChild,a=t.which===d,s=t.which===u||t.shiftKey,c=s&&a,r=!s&&a;this.releaseFocus(),this.captureFocus(this.focusContainerSelector),c&&(o||n)?(t.preventDefault(),this.focusableLastChild.focus()):r&&i&&(t.preventDefault(),this.focusableFirstChild.focus())}}]),t}(),g=27,A="data-modal",y="data-modal-id",m="data-modal-button",_="no-scroll",C="data-visible",E="data-close",p="data-target",S="aria-hidden",M="aria-modal",k="role",F="tabindex",O="keydown",w="click",B="Your button is missing its corresponding modal. Check to make sure your modal is in the DOM, and that it has a [data-modal-id=*] attribute matchin its [data-modal-button] and [data-target] attributes. It's possible the modal script ran before the button appeared on the page!",t=function(t){function e(){var t;return n(this,e),(t=l(this,s(e).call(this)))._getModal=t._getModal.bind(r(r(t))),t._handleModalClose=t._handleModalClose.bind(r(r(t))),t._handleEscapeKeyPress=t._handleEscapeKeyPress.bind(r(r(t))),t._handleOverlayClick=t._handleOverlayClick.bind(r(r(t))),t.modalContainerAttr="[".concat(A,"]"),t.closeButtonAttr="[".concat(A,"] [").concat(E,"]"),t.modals=null,t.modalButtons=null,t.closeButtons=null,t.activeModalButton={},t.activeModalId="",t.activeModalOverlayAttr="",t.activeModalOverlay={},t.activeModalSelector="",t.activeModal=null,t.activeModalCloseButtons=[],t}return a(e,b),i(e,[{key:"start",value:function(){var e=this;this.modals=this._getElements(this.modalContainerAttr),this.modalButtons=this._getElements("[".concat(m,"]")),this.closeButtons=this._getElements(this.closeButtonAttr),this._getFocusableElements(this.modalContainerAttr).forEach(function(t){t.setAttribute(F,"-1")}),this.modals.length&&this.modals.forEach(function(t){t.setAttribute(M,"true"),t.parentNode.setAttribute(S,"true"),t.parentNode.setAttribute(C,"false"),t.setAttribute(k,"dialog")}),this.modalButtons.length&&this.modalButtons.forEach(function(t){t.addEventListener(w,e._getModal)})}},{key:"stop",value:function(){var e=this;this.modalButtons.forEach(function(t){t.removeEventListener(w,e._getModal)})}},{key:"_getModal",value:function(t){t.preventDefault(),this._renderModal(t)}},{key:"_renderModal",value:function(t){var e=this;if(this.activeModalButton=t.target,this.activeModalId=this.activeModalButton.getAttribute(p),this.activeModalOverlayAttr="[".concat(y,"='").concat(this.activeModalId,"']"),this.activeModalOverlay=document.querySelector(this.activeModalOverlayAttr),!this.activeModalOverlay)throw B;this.activeModalSelector="".concat(this.activeModalOverlayAttr," ").concat(this.modalContainerAttr),this.activeModal=document.querySelector(this.activeModalSelector),this.activeModalCloseButtons=this._getElements("".concat(this.activeModalOverlayAttr," ").concat(this.closeButtonAttr)),this._getFocusableElements(this.activeModalSelector).forEach(function(t){t.setAttribute(F,"0")}),this._handleScrollStop(),this.captureFocus(this.activeModalSelector),this.activeModalOverlay.setAttribute(S,"false"),this.activeModal.setAttribute("tabindex","-1"),this.activeModalOverlay.setAttribute(C,"true"),this.activeModal.focus(),this.activeModalOverlay.scrollTop=0,document.addEventListener(O,this._handleEscapeKeyPress),document.addEventListener(w,this._handleOverlayClick),this.activeModalCloseButtons.forEach(function(t){t.addEventListener(w,e._handleModalClose)})}},{key:"_handleModalClose",value:function(t){var e=this;t.preventDefault(),this.activeModalOverlay.setAttribute(C,"false"),this._handleReturnFocus(),this._handleScrollRestore(),this.releaseFocus(),this.activeModalOverlay.setAttribute(S,"true"),this.activeModal.removeAttribute("tabindex"),this._getFocusableElements(this.activeModalSelector).forEach(function(t){t.setAttribute(F,"-1")}),document.removeEventListener(O,this._handleEscapeKeyPress),document.removeEventListener(w,this._handleOverlayClick),this.activeModalCloseButtons.forEach(function(t){t.removeEventListener(w,e._handleModalClose)})}},{key:"_handleOverlayClick",value:function(t){t.target===this.activeModalOverlay&&this._handleModalClose(t)}},{key:"_handleEscapeKeyPress",value:function(t){t.which===g&&this._handleModalClose(t)}},{key:"_handleReturnFocus",value:function(){this.activeModalButton.setAttribute("tabindex","-1"),this.activeModalButton.focus(),this.activeModalButton.removeAttribute("tabindex")}},{key:"_handleScrollRestore",value:function(){document.body.classList.remove(_),document.querySelector("html").classList.remove(_)}},{key:"_handleScrollStop",value:function(){document.body.classList.add(_),document.querySelector("html").classList.add(_)}}]),e}(),L=32,x="data-accordion",R="data-accordion-row",K="data-expanded",I="data-target",P="data-content",T="data-toggle-multiple",j="data-parent",q="aria-expanded",H="aria-controls",D="aria-hidden",U="tabindex",Y="click",G="keydown",N="You have an accordion button that is missing its [data-content] attribute, and has a matching id to the button's [data-target] attribute's value.",e=function(t){function e(){var t;return n(this,e),(t=l(this,s(e).call(this)))._renderAccordionContent=t._renderAccordionContent.bind(r(r(t))),t._handleSpaceKeyPress=t._handleSpaceKeyPress.bind(r(r(t))),t.accordionButtons=null,t.accordionContentsAttr="",t.accordionContents=[],t.activeContainer={},t.activeButton={},t.activeAccordionRowId="",t.activeRowAttr="",t.activeRow="",t.activeContainerId="",t.activeContainerAttr="",t.activeContainer={},t.activeContent={},t.toggleExpandState=null,t.toggleContentState=null,t.toggleHiddenState=null,t.allContentAttr="",t}return a(e,b),i(e,[{key:"start",value:function(){var o=this;this.accordionButtons=this._getElements("[".concat(x,"] [").concat(I,"]")),this.accordionContentsAttr="[".concat(x,"] [").concat(P,"]"),this.accordionContents=this._getElements(this.accordionContentsAttr),this._getFocusableElements(this.accordionContentsAttr).forEach(function(t){t.setAttribute(U,"-1")}),this.accordionButtons.length&&this.accordionButtons.forEach(function(t){o._setupButton(t),t.addEventListener(Y,o._renderAccordionContent),t.addEventListener(G,o._handleSpaceKeyPress)}),this.accordionContents.length&&this.accordionContents.forEach(function(t){var e=o._getAccordionRowAttr(t.id),n="true"===document.querySelector(e).getAttribute(K)?"false":"true";t.setAttribute(D,n),"false"===n&&o._getFocusableElements("#".concat(t.id)).forEach(function(t){t.setAttribute(U,"0")})})}},{key:"stop",value:function(){var e=this;this.accordionButtons.forEach(function(t){t.removeEventListener(Y,e._renderAccordionContent),t.removeEventListener(G,e._handleSpaceKeyPress)})}},{key:"_setupButton",value:function(t){var e=t.getAttribute(I),n=this._getAccordionRowAttr(e),o=document.querySelector(n).getAttribute(K),i=document.getElementById(e);t.setAttribute(H,e),"true"===o?(i.style.maxHeight="".concat(i.scrollHeight,"px"),t.setAttribute(q,"true")):t.setAttribute(q,"false")}},{key:"_getAccordionRowAttr",value:function(t){return"[".concat(R,"='").concat(t,"']")}},{key:"_renderAccordionContent",value:function(t){if(t.preventDefault(),this.activeButton=t.target,this.activeAccordionRowId=this.activeButton.getAttribute(I),this.activeRowAttr=this._getAccordionRowAttr(this.activeAccordionRowId),this.activeRow=document.querySelector(this.activeRowAttr),this.activeContainerId=this.activeButton.getAttribute(j),this.activeContainerAttr="[".concat(x,"='").concat(this.activeContainerId,"']"),this.activeContainer=document.querySelector(this.activeContainerAttr),this.activeContent=document.getElementById(this.activeAccordionRowId),!this.activeContent.hasAttribute(P))throw N;var e=this.activeRow.getAttribute(K),n=this.activeContent.getAttribute(P);this.toggleExpandState="true"===e?"false":"true",this.toggleContentState="visible"===n?"hidden":"visible",this.toggleHiddenState="false"===this.toggleExpandState?"true":"false",this._closeAllIfToggleable(),this._toggleSelectedAccordion()}},{key:"_handleSpaceKeyPress",value:function(t){t.which===L&&this._renderAccordionContent(t)}},{key:"_closeAllIfToggleable",value:function(){var e=this;if(!this.activeContainer.hasAttribute(T)){this.allContentAttr="".concat(this.activeContainerAttr," [").concat(P,"]");var t=this._getElements("".concat(this.activeContainerAttr," [").concat(K,"]")),n=this._getElements(this.allContentAttr),o=this._getElements("".concat(this.activeContainerAttr," [").concat(I,"]"));n.forEach(function(t){t!==e.activeContent&&(t.style.maxHeight=null)}),this._getFocusableElements(this.allContentAttr).forEach(function(t){t.setAttribute(U,"-1")}),this._toggleAttributeInCollection(t,K,"true","false"),this._toggleAttributeInCollection(o,q,"true","false"),this._toggleAttributeInCollection(n,D,"false","true"),this._toggleAttributeInCollection(n,P,"visible","hidden")}}},{key:"_toggleSelectedAccordion",value:function(){var n=this;this.activeRow.setAttribute(K,this.toggleExpandState),this.activeContent.setAttribute(P,this.toggleContentState),this.activeButton.setAttribute(q,this.toggleExpandState),this.activeContent.setAttribute(D,this.toggleHiddenState);var t="#".concat(this.activeAccordionRowId);this._getFocusableElements(t).forEach(function(t){var e="true"===n.toggleExpandState?"0":"-1";t.setAttribute(U,e)}),this.activeContent.style.maxHeight?this.activeContent.style.maxHeight=null:this.activeContent.style.maxHeight="".concat(this.activeContent.scrollHeight,"px")}},{key:"_toggleAttributeInCollection",value:function(t,e,n,o){t.forEach(function(t){t.hasAttribute(e,n)&&t.setAttribute(e,o)})}}]),e}(),Undernet={Modals:new t,Accordions:new e,Utils:new b,start:function(){Undernet.Modals.start(),Undernet.Accordions.start(),Undernet.Utils.enableFocusOutline()},stop:function(){Undernet.Modals.stop(),Undernet.Accordions.stop(),Undernet.Utils.disableFocusOutline()}};return window.Undernet=Undernet});
//# sourceMappingURL=undernet.bundle.min.js.map
